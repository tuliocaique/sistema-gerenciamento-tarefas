async function getToken(){let a=null;try{a=await $.ajax({type:"GET",url:"api/token",dataType:"json"})}catch(a){$(location).attr("href","login")}return a.refreshToken}async function getDadosUsuario(a){$.ajax({type:"GET",url:"api/usuario",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+a)},success:function(a){$("#emailUsuario").val(a.usuario.email),$(".cod-usuario").val(a.usuario.cod)},error:function(a){}})}async function deletarUsuario(a){let e=$("#btn-deletar-usuario");$.ajax({type:"DELETE",url:"api/usuario",contentType:"application/json",dataType:"json",beforeSend:function(s){s.setRequestHeader("Authorization","Bearer "+a),e.addClass("disabled"),e.html('<div class="spinner-border text-light" role="status"><span class="sr-only">Loading...</span></div> <span>Deletando</span>')},success:function(a){a.success?toastr.success("Aguarde...",a.message,{timeOut:3e3,fadeOut:3e3,onHidden:function(){$(location).delay(1e3).attr("href","login")}}):(toastr.error(a.message),e.removeClass("disabled"),e.html("Login"))},error:function(a){e.removeClass("disabled"),e.html("Deletar"),toastr.error(a)}})}async function alterarEmailUsuario(a){let e=$("#alterarEmailUsuario").serialize(),s=$("#btn-alterar-email");$.ajax({type:"PUT",url:"api/usuario",data:e,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+a),s.addClass("disabled"),s.html('<div class="spinner-border text-light" role="status"><span class="sr-only">Loading...</span></div> <span>Deletando</span>')},success:function(a){a.success?toastr.success(a.message):toastr.error(a.message)},error:function(a){toastr.error(a)},complete:function(){s.removeClass("disabled"),s.html('<i class="fas fa-save"></i> Salvar Alteração')}})}async function alterarSenhaUsuario(a){let e=$("#alterarSenhaUsuario").serialize(),s=$("#btn-alterar-senha");$.ajax({type:"PUT",url:"api/usuario",data:e,contentType:"application/json",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+a),s.addClass("disabled"),s.html('<div class="spinner-border text-light" role="status"><span class="sr-only">Loading...</span></div> <span>Deletando</span>')},success:function(a){a.success?toastr.success(a.message):toastr.error(a.message)},error:function(a){toastr.error(a)},complete:function(){s.removeClass("disabled"),s.html('<i class="fas fa-save"></i> Salvar Alteração')}})}async function iniciarUsuario(a){await getDadosUsuario(a)}$(document).ready(function(){getToken().then(a=>iniciarUsuario(a)),$("#deletarUsuario").submit(function(a){getToken().then(a=>deletarUsuario(a)),a.preventDefault()}),$("#alterarEmailUsuario").submit(function(a){getToken().then(a=>alterarEmailUsuario(a)),a.preventDefault()}),$("#alterarSenhaUsuario").submit(function(a){getToken().then(a=>alterarSenhaUsuario(a)),a.preventDefault()})});